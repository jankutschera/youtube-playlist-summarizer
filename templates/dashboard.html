{% extends "base.html" %}

{% block content %}
<div class="search-bar">
    <input type="text" id="searchInput" placeholder="ðŸ” Videos durchsuchen..." onkeyup="searchVideos()">
</div>

<div class="stats">
    <div class="stat-card">
        <h3>Verarbeitete Videos</h3>
        <div class="number">{{ total }}</div>
    </div>
    <div class="stat-card">
        <h3>Status</h3>
        <div class="number" style="font-size: 20px; color: #0f0;">âœ“ Aktiv</div>
    </div>
</div>

{% if videos %}
<div class="video-grid" id="videoGrid">
    {% for video in videos %}
    <div class="video-card" onclick="window.location.href='/video/{{ video.id }}'">
        <img src="{{ video.thumbnail }}" alt="{{ video.title }}">
        <div class="video-info">
            <div class="video-title">{{ video.title }}</div>
            <div class="video-meta">
                {{ video.channel }}<br>
                <small>{{ video.processed_at }}</small>
            </div>
            {% if video.summary %}
            <div class="video-summary">
                {{ (video.summary[:200] + '...') | markdown_to_html | safe }}
            </div>
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="empty-state">
    <h2>Noch keine Videos verarbeitet</h2>
    <p>FÃ¼ge Videos zu deiner Watch Later Liste hinzu, und sie werden automatisch hier erscheinen.</p>
</div>
{% endif %}

{% endblock %}

{% block extra_js %}
<script>
function searchVideos() {
    const input = document.getElementById('searchInput');
    const filter = input.value.toLowerCase();
    const grid = document.getElementById('videoGrid');
    const cards = grid.getElementsByClassName('video-card');

    for (let card of cards) {
        const title = card.querySelector('.video-title').textContent.toLowerCase();
        const meta = card.querySelector('.video-meta').textContent.toLowerCase();
        const summary = card.querySelector('.video-summary')?.textContent.toLowerCase() || '';

        if (title.includes(filter) || meta.includes(filter) || summary.includes(filter)) {
            card.style.display = '';
        } else {
            card.style.display = 'none';
        }
    }
}
</script>
{% endblock %}
